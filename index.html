<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zero Gravity Group</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"> 
    <link rel="icon" type="image/png" href="assests/logo-zerogravity.png">
    <link rel="stylesheet" href="style.css">



</head>
<body>
    <!-- Navbar Section --> 
    <nav class="navbar">
        <div class="logo">
            <img src="assests/logo-zerogravity.png" alt="Zero Gravity Group Logo">
        </div>
        
        <a href="https://zerogravity.group/" target="_blank">More info</a>
    </nav>

    <section class="hero-section">                
    
            <div class="form-content-wrapper">
                    <h1 class="header">One Group, Endless Creative & Business Solutions.<br>in Chennai</h1>

                <div class="contact-form">
                    
                    
                    <form id="quoteForm" name="submit-to-google-sheet-2">
                        <div class="form-group">
                          <label for="name">Name <span style="color:red">*</span></label>
                          <input type="text" id="name" name="name" placeholder="Enter Your Name" required>
                        </div>
                      
                        <div class="form-group">
                          <label for="company">Contact Number <span style="color:red">*</span></label>
                          <input type="tel" id="contact number" name="contact-number" placeholder="contact number" required>
                        </div>
                    
                        <div class="form-group">
                          <label for="phoneNumber">Designation<span style="color:red">*</span></label>
                          <input type="text" id="Designation" name="phone-number" placeholder="Designation" required>
                        </div>

                         <div class="form-group">
                          <label for="phoneNumber">Company Name</label>
                          <input type="text" id="company name" name="company-name" placeholder="company name">
                        </div>

                        <div class="form-group">
                          <label for="">Enquiry Products</label>
                          <select name="enquiry-products" id="enquiry-products" required>
                                <option value="PHOTOGRAPHY">PHOTOGRAPHY</option>
                                <option value="DIVINE CATERS">DIVINE CATERERS</option>
                                <option value="VERMILLION">VERMILLION DECORS</option>
                                <option value="ALBUMS">ALBUMS</option>
                                <option value="RIGID BOX">RIGID BOX</option>
                                <option value="ZG SHOP">ZG SHOP</option>
                                <option value="ZG DIGITAL">ZG DIGITAL</option>
                                <option value="SOFTWARE">ZG SOFTWARE</option>
                            </select>
                         </div>
                      
                        <button type="submit" id="submitBtn">Get Quote</button>
                      </form>
                      
                </div>
                 
            </div>
        
    </section>



    <script>
        // google sheet connect
const scriptURL = 'https://script.google.com/macros/s/AKfycbyQQJFIFGPcr1h2b0RTsNx0RrVCFZwFij2U7C1mqsL9cC1YtuSliiBE1Gnn2q4pPGve/exec';


const contactForm = document.forms['submit-to-google-sheet-2'];

function handleSubmit(form) {
  const popup = document.createElement('div');
  popup.id = 'popup-message';
  document.body.appendChild(popup);

  form.addEventListener('submit', async e => {
    e.preventDefault();

    const submitBtn = document.getElementById('submitBtn');
    // query overlay at submit time (overlay is after this script in the DOM)
    const loadingOverlay = document.getElementById('loadingOverlay');

    function showLoading(show) {
      if (loadingOverlay) {
        loadingOverlay.style.display = show ? 'flex' : 'none';
        loadingOverlay.setAttribute('aria-hidden', show ? 'false' : 'true');
      }
      if (submitBtn) submitBtn.disabled = show;
    }

    showLoading(true);

    try {
      const res = await fetch(scriptURL, { method: 'POST', body: new FormData(form) });
      // try to parse JSON if returned, otherwise fallback
      let data = null;
      try { data = await res.json(); } catch (err) { /* non-json response */ }

      if (data && data.result === 'success') {
        showPopup('<i class="fa-solid fa-circle-check" style="color:#4caf50; font-size: 24px; margin-right: 8px;"></i><span class="thankyou-highlight">Thank you!</span><br>Your response has been submitted successfully.', 'success', popup);
        form.reset();
      } else if (res.ok && !data) {
        // server returned ok but no JSON - assume success
        showPopup('<i class="fa-solid fa-circle-check" style="color:#4caf50; font-size: 24px; margin-right: 8px;"></i><span class="thankyou-highlight">Thank you!</span><br>Your response has been submitted successfully.', 'success', popup);
        form.reset();
      } else {
        const errMsg = data && data.error ? data.error : 'Submission failed. Please try again.';
        showPopup('❌ Submission failed:<br>' + errMsg, 'error', popup);
      }

    } catch (err) {
      showPopup('❌ Submission error!<br>Please try again later.', 'error', popup);
    } finally {
      showLoading(false);
    }
  });
}

function showPopup(message, type, popup) {
  popup.innerHTML = `
      <div class="popup-content-side">
        <div class="popup-message">${message}</div>
        <button id="popup-ok">OK</button>
      </div>
  `;
  popup.className = type;
  popup.style.display = 'block';

  document.getElementById('popup-ok').onclick = function () {
    popup.style.display = 'none';
  };
}

handleSubmit(contactForm);

  </script>

<!-- Loading overlay: shown while the form is submitting -->
<div class="overlay" id="loadingOverlay" aria-hidden="true" style="display:none;">
  <div class="loading-container">
    <div class="spinner" aria-hidden="true"></div>
    <div class="loading-text">Submitting your request...</div>
  </div>
</div>
</body>
</html>